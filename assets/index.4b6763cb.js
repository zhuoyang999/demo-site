var ce=Object.defineProperty,le=Object.defineProperties;var ue=Object.getOwnPropertyDescriptors;var H=Object.getOwnPropertySymbols;var pe=Object.prototype.hasOwnProperty,de=Object.prototype.propertyIsEnumerable;var F=(t,o,n)=>o in t?ce(t,o,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[o]=n,S=(t,o)=>{for(var n in o||(o={}))pe.call(o,n)&&F(t,n,o[n]);if(H)for(var n of H(o))de.call(o,n)&&F(t,n,o[n]);return t},q=(t,o)=>le(t,ue(o));import{c as me,z as _e,E as fe,u as N,r as h,a as ge,o as u,b as _,w as i,d,e as c,f as he,g as V,h as Y,i as k,j as ve,k as Q,l as ye,m as Ie,n as ke,p as Ee,q as E,s as m,t as y,v as I,x as B,F as U,y as j,A as X,B as be,C as we,D as Le,G as Re,H as J,I as W,J as Pe,K as Ae,L as Oe,M as G,N as Te,O as K}from"./vendor.a206512a.js";const Se=function(){const o=document.createElement("link").relList;if(o&&o.supports&&o.supports("modulepreload"))return;for(const e of document.querySelectorAll('link[rel="modulepreload"]'))s(e);new MutationObserver(e=>{for(const r of e)if(r.type==="childList")for(const a of r.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&s(a)}).observe(document,{childList:!0,subtree:!0});function n(e){const r={};return e.integrity&&(r.integrity=e.integrity),e.referrerpolicy&&(r.referrerPolicy=e.referrerpolicy),e.crossorigin==="use-credentials"?r.credentials="include":e.crossorigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function s(e){if(e.ep)return;e.ep=!0;const r=n(e);fetch(e.href,r)}};Se();var De={sitename:"\u6743\u9650\u7BA1\u7406\u7CFB\u7EDF",personalCenter:"\u4E2A\u4EBA\u4E2D\u5FC3",logout:"\u9000\u51FA",login:"\u767B\u5F55",tips404:"\u5BF9\u4E0D\u8D77\uFF01\u9875\u9762\u627E\u4E0D\u5230\u4E86......",backHome:"\u8FD4\u56DE\u9996\u9875",form:{username:"\u7528\u6237\u540D",usernameHolder:"\u8BF7\u8F93\u5165\u7528\u6237\u540D",usernameError:"\u7528\u6237\u540D\u7531\u82F1\u6587\u5B57\u6BCD\u5F00\u5934\u7684\u957F\u5EA64-32\u4F4D\u5B57\u6BCD\u3001_\u548C-\u7EC4\u6210",password:"\u5BC6\u7801",passwordHolder:"\u8BF7\u8F93\u5165\u5BC6\u7801",passwordError:"\u8BF7\u8F93\u5165\u81F3\u5C114\u4E2A\u5B57\u7B26\u7684\u5BC6\u7801"},menu:{App:"\u5E94\u7528\u7BA1\u7406",AppUser:"\u7528\u6237\u7BA1\u7406",AppDept:"\u673A\u6784\u7BA1\u7406",AppRole:"\u89D2\u8272\u7BA1\u7406",AppResource:"\u8D44\u6E90\u7BA1\u7406",AppPermission:"\u6388\u6743\u7BA1\u7406",Sys:"\u7CFB\u7EDF\u7BA1\u7406",SysUser:"\u7528\u6237\u7BA1\u7406",SysNotice:"\u516C\u544A\u7BA1\u7406",Logs:"\u5BA1\u8BA1\u7BA1\u7406",LogsVisit:"\u8BBF\u95EE\u65E5\u5FD7",LogsOperation:"\u64CD\u4F5C\u65E5\u5FD7"}},Ce={sitename:"PM SYSTEM",personalCenter:"Percenal Center",logout:"Exit",login:"Login",tips404:"Sorry, page Not Found!",backHome:"Back to HomePage",form:{username:"Username",usernameHolder:"Please enter your username.",usernameError:"Username can only start with an alphabet and contains 4~32 characters with alphabet, _ and -.",password:"Password",passwordHolder:"Please enter your password.",passwordError:"Please enter a password of at least 4 characters"},menu:{App:"Website",AppUser:"User",AppDept:"Department",AppRole:"Role",AppResource:"Resource",AppPermission:"Permission",Sys:"System",SysUser:"User",SysNotice:"Notice",Logs:"Logs",LogsVisit:"Visits",LogsOperation:"Operations"}};const xe=me({legacy:!1,locale:"zh-cn",fallbackLocale:"zh-cn",messages:{"zh-cn":De,en:Ce}}),$e={"zh-cn":_e,en:fe};const Ve={setup(t){const{locale:o}=N();return o.value=localStorage.getItem("locale")||"zh-cn",(n,s)=>{const e=h("router-view"),r=ge;return u(),_(r,{locale:d($e)[d(o)]},{default:i(()=>[c(e)]),_:1},8,["locale"])}}},Ue="modulepreload",Z={},Ne="/demo-site/",p=function(o,n){return!n||n.length===0?o():Promise.all(n.map(s=>{if(s=`${Ne}${s}`,s in Z)return;Z[s]=!0;const e=s.endsWith(".css"),r=e?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${s}"]${r}`))return;const a=document.createElement("link");if(a.rel=e?"stylesheet":Ue,e||(a.as="script",a.crossOrigin=""),a.href=s,document.head.appendChild(a),e)return new Promise((w,f)=>{a.addEventListener("load",w),a.addEventListener("error",()=>f(new Error(`Unable to preload CSS for ${s}`)))})})).then(()=>o())};var ee={method:"get",baseURL:"http://localhost:8001",headers:{"Content-Type":"application/json;charset=UTF-8"},timeout:1e4,withCredentials:!0,responseType:"json"};function x(t){return new Promise((o,n)=>{const s=he.create(S({},ee));s.interceptors.request.use(e=>{let r=localStorage.getItem("pm_token");return r?e.headers.token=r:b.push("/login"),e},e=>(console.log("request:",e),e.code==="ECONNABORTED"&&e.message.indexOf("timeout")!==-1&&V({message:"\u8BF7\u6C42\u8D85\u65F6",type:"error",showClose:!0}),Promise.reject(e))),s.interceptors.response.use(e=>e.data,e=>{if(e&&e.response)switch(e.response.status){case 400:e.message="\u8BF7\u6C42\u9519\u8BEF";break;case 401:e.message="\u672A\u6388\u6743\uFF0C\u8BF7\u767B\u5F55";break;case 403:e.message="\u62D2\u7EDD\u8BBF\u95EE";break;case 404:e.message=`\u8BF7\u6C42\u5730\u5740\u51FA\u9519: ${e.response.config.url}`;break;case 408:e.message="\u8BF7\u6C42\u8D85\u65F6";break;case 500:e.message="\u670D\u52A1\u5668\u5185\u90E8\u9519\u8BEF";break;case 501:e.message="\u670D\u52A1\u672A\u5B9E\u73B0";break;case 502:e.message="\u7F51\u5173\u9519\u8BEF";break;case 503:e.message="\u670D\u52A1\u4E0D\u53EF\u7528";break;case 504:e.message="\u7F51\u5173\u8D85\u65F6";break;case 505:e.message="HTTP\u7248\u672C\u4E0D\u53D7\u652F\u6301";break}return console.error(e),e.message&&V({message:e.message,type:"error",showClose:!0}),Promise.reject(e)}),s(t).then(e=>{e.code===200?o(e):(e.code===-2&&b.push("/login"),V({message:e.msg||"\u64CD\u4F5C\u5931\u8D25",type:"error",showClose:!0}),n(e))}).catch(e=>{n(e)})})}const Et=t=>x({url:"login",method:"post",data:t}),je=()=>x({url:"logout",method:"get"});const Me={class:"header-cont"},ze={class:"left"},He={class:"right flex-center"},Fe={class:"lang gap"},qe=y(" / "),Be={class:"gap"},Je={class:"flex-center cursor"},We={setup(t){const{locale:o,t:n}=N();function s(l){o.value=l,localStorage.setItem("locale",l)}const e=Y(),r=k(()=>e.getters["user/isLogin"]),a=k(()=>e.state.user.userInfo),w=k(()=>{var l;return(l=a.value)==null?void 0:l.name}),f=k(()=>{var l;return(l=a.value)==null?void 0:l.unReadCount});e.dispatch("user/refreshInfo");const L=ve(),R={toPersonal:()=>{L.push("/personal")},toLogout:()=>{je().then(l=>{l.code==200&&(e.commit("user/clearToken"),e.commit("user/clearUserInfo"),L.push("/login"))})}};function A(l){R[l]&&R[l]()}return(l,P)=>{const O=h("router-link"),g=h("message"),C=Q,T=ye,$=h("caret-bottom"),z=Ie,re=ke,ae=Ee;return u(),E("div",Me,[m("div",ze,[m("h1",null,[c(O,{to:"/"},{default:i(()=>[y(I(d(n)("sitename")),1)]),_:1})])]),m("div",He,[m("div",Fe,[m("span",{class:B(["item",{active:d(o)==="zh-cn"}]),onClick:P[0]||(P[0]=ie=>s("zh-cn"))},"\u7B80\u4F53\u4E2D\u6587",2),qe,m("span",{class:B(["item",{active:d(o)==="en"}]),onClick:P[1]||(P[1]=ie=>s("en"))},"EN",2)]),d(r)?(u(),E(U,{key:0},[m("div",Be,[c(O,{to:"/personal/message"},{default:i(()=>[c(T,{"is-dot":!!d(f)},{default:i(()=>[c(C,null,{default:i(()=>[c(g)]),_:1})]),_:1},8,["is-dot"])]),_:1})]),c(ae,{trigger:"click",onCommand:A},{dropdown:i(()=>[c(re,null,{default:i(()=>[c(z,{command:"toPersonal"},{default:i(()=>[y(I(d(n)("personalCenter")),1)]),_:1}),c(z,{command:"toLogout"},{default:i(()=>[y(I(d(n)("logout")),1)]),_:1})]),_:1})]),default:i(()=>[m("div",Je,[y(I(d(w))+" ",1),c(C,null,{default:i(()=>[c($)]),_:1})])]),_:1})],64)):l.$route.name!=="Login"?(u(),_(O,{key:1,to:"/login"},{default:i(()=>[y(I(d(n)("login")),1)]),_:1})):j("",!0)])])}}};const Ge={class:"page-sidebar"},Ke={class:"collape-bar"},Ze={setup(t){const o=X(),n=Y(),{t:s}=N(),e=k(()=>n.state.menuTree),r=k(()=>o.path||e.value[0].path),a=be(!1);return(w,f)=>{const L=h("expand"),R=h("fold"),A=Q,l=we,P=Le,O=Re;return u(),E("div",Ge,[m("div",Ke,[c(A,{class:"cursor",onClick:f[0]||(f[0]=g=>a.value=!a.value)},{default:i(()=>[a.value?(u(),_(L,{key:0})):(u(),_(R,{key:1}))]),_:1})]),c(O,{"default-active":d(r),router:"",class:"sidemenu",collapse:a.value},{default:i(()=>[(u(!0),E(U,null,J(d(e),(g,C)=>(u(),_(P,{key:C,index:g.path},{title:i(()=>[g.icon?(u(),_(A,{key:0},{default:i(()=>[(u(),_(W(g.icon)))]),_:2},1024)):j("",!0),m("span",null,I(d(s)(`menu.${g.name}`)),1)]),default:i(()=>[(u(!0),E(U,null,J(g.children,(T,$)=>(u(),_(l,{key:$,index:T.path},{default:i(()=>[c(A,null,{default:i(()=>[(u(),_(W(T.icon)))]),_:2},1024),y(" "+I(d(s)(`menu.${T.name}`)),1)]),_:2},1032,["index"]))),128))]),_:2},1032,["index"]))),128))]),_:1},8,["default-active","collapse"])])}}};const Ye={class:"page-container"},Qe={key:0,class:"left"},Xe={class:"right"},et={setup(t){const o=X(),n=k(()=>{const s=o.name;return!["Login","NotFound"].includes(s)&&!/^Personal/.test(s)});return(s,e)=>{const r=h("router-view");return u(),E("div",Ye,[m("header",null,[c(We)]),m("main",null,[d(n)?(u(),E("div",Qe,[c(Ze)])):j("",!0),m("div",Xe,[c(r)])])])}}};var tt=(t,o)=>{const n=t.__vccOpts||t;for(const[s,e]of o)n[s]=e;return n};const ot={};function nt(t,o,n,s,e,r){const a=h("router-view");return u(),_(a)}var st=tt(ot,[["render",nt]]);const rt=t=>x({url:"personal/userinfo",method:"get",data:t}),at=t=>x({url:"personal/menuTree",method:"get",data:t});var it={namespaced:!0,state:{token:"",userInfo:{}},getters:{isLogin(t){return!!t.token||!!localStorage.getItem("pm_token")}},mutations:{setToken(t,o){localStorage.setItem("pm_token",o),t.token=o},clearToken(t){t.token="",localStorage.removeItem("pm_token")},setUserInfo(t,o){t.userInfo=o||{}},clearUserInfo(t){t.userInfo={}}},actions:{refreshInfo({commit:t}){rt().then(o=>{t("setUserInfo",o.data)})}}},v=Pe({state:{routeLoaded:!1,firstRoute:null,menuTree:null},mutations:{setRouteLoaded(t,o){t.routeLoaded=o},setFirstRoute(t,o){t.firstRoute=o},setMenuTree(t,o){t.menuTree=o}},actions:{},modules:{user:it}});const ct=[{path:"/",name:"Home",component:et,children:[{path:"login",name:"Login",component:()=>p(()=>import("./index.c1b9323d.js"),["assets/index.c1b9323d.js","assets/index.12e44def.css","assets/vendor.a206512a.js","assets/vendor.634d5413.css"])},{path:"404",name:"NotFound",component:()=>p(()=>import("./404.abf1a431.js"),["assets/404.abf1a431.js","assets/404.3d0940fc.css","assets/vendor.a206512a.js","assets/vendor.634d5413.css"])},{path:"personal",name:"Personal",meta:{requireAuth:!0},component:()=>p(()=>import("./index.acc0edbc.js"),["assets/index.acc0edbc.js","assets/vendor.a206512a.js","assets/vendor.634d5413.css"]),children:[{path:"message",name:"PersonalMessage",meta:{requireAuth:!0},component:()=>p(()=>import("./Message.82461f36.js"),["assets/Message.82461f36.js","assets/Message.83779299.css","assets/vendor.a206512a.js","assets/vendor.634d5413.css"])}]}]}],lt={path:"/:pathMatch(.*)*",name:"404",redirect:"/404"},b=Ae({history:Oe("/demo-site/"),routes:ct});b.beforeEach(async t=>{const o=v.getters["user/isLogin"];return t.path==="/login"?o?{name:"Home"}:!0:t.meta.requireAuth&&!o?{name:"Login"}:(await pt(),!t.name&&ut(t)?S({},t):t.path==="/"&&v.state.firstRoute?v.state.firstRoute:!0)});function ut(t){return!!b.getRoutes().find(n=>n.path===t.path)}function pt(){if(!v.state.routeLoaded)return at().then(t=>{t.data&&t.data.length&&te(t.data),b.addRoute(lt),v.commit("setRouteLoaded",!0),v.commit("setMenuTree",t.data)})}const dt={"../views/404.vue":()=>p(()=>import("./404.abf1a431.js"),["assets/404.abf1a431.js","assets/404.3d0940fc.css","assets/vendor.a206512a.js","assets/vendor.634d5413.css"]),"../views/app/Dept.vue":()=>p(()=>import("./Dept.52f4c848.js"),["assets/Dept.52f4c848.js","assets/vendor.a206512a.js","assets/vendor.634d5413.css"]),"../views/app/Resource.vue":()=>p(()=>import("./Resource.ba9ab56d.js"),["assets/Resource.ba9ab56d.js","assets/vendor.a206512a.js","assets/vendor.634d5413.css"]),"../views/app/Role.vue":()=>p(()=>import("./Role.5b2d2345.js"),["assets/Role.5b2d2345.js","assets/vendor.a206512a.js","assets/vendor.634d5413.css"]),"../views/app/User.vue":()=>p(()=>import("./User.6edc3ccb.js"),["assets/User.6edc3ccb.js","assets/vendor.a206512a.js","assets/vendor.634d5413.css"]),"../views/login/index.vue":()=>p(()=>import("./index.c1b9323d.js"),["assets/index.c1b9323d.js","assets/index.12e44def.css","assets/vendor.a206512a.js","assets/vendor.634d5413.css"]),"../views/logs/Operation.vue":()=>p(()=>import("./Operation.dbaacc2f.js"),["assets/Operation.dbaacc2f.js","assets/vendor.a206512a.js","assets/vendor.634d5413.css"]),"../views/logs/Visit.vue":()=>p(()=>import("./Visit.43c78520.js"),["assets/Visit.43c78520.js","assets/vendor.a206512a.js","assets/vendor.634d5413.css"]),"../views/personal/Message.vue":()=>p(()=>import("./Message.82461f36.js"),["assets/Message.82461f36.js","assets/Message.83779299.css","assets/vendor.a206512a.js","assets/vendor.634d5413.css"]),"../views/personal/index.vue":()=>p(()=>import("./index.acc0edbc.js"),["assets/index.acc0edbc.js","assets/vendor.a206512a.js","assets/vendor.634d5413.css"]),"../views/sys/Notice.vue":()=>p(()=>import("./Notice.fba5a0d3.js"),["assets/Notice.fba5a0d3.js","assets/vendor.a206512a.js","assets/vendor.634d5413.css"]),"../views/sys/User.vue":()=>p(()=>import("./User.a662407e.js"),["assets/User.a662407e.js","assets/vendor.a206512a.js","assets/vendor.634d5413.css"])};function te(t,o){t.forEach((n,s)=>{const e={path:n.path,name:n.name,meta:{title:n.title,icon:n.icon},children:[]};if(o){if(n.parentId!==0){const r=n.path.replace("/","").split("/"),a=r.length-1,w=r.map((f,L)=>L===a?f.replace(/\w/,R=>R.toUpperCase())+".vue":f).join("/");e.path=r[a],e.component=dt[`../views/${w}`],o.children.push(e)}}else n.children&&n.children.length&&(e.redirect=n.children[0].path,te(n.children,e)),e.component=st,s===0&&v.commit("setFirstRoute",e),b.addRoute("Home",e)})}const M=[{name:"visitor",roleId:"visitor",password:"visitor"},{name:"master",roleId:"master",password:"master"},{name:"admin",roleId:"admin",password:"admin"}],D=[{id:1,parentId:0,name:"App",path:"/app",icon:"el-icon-menu",children:[{id:11,parentId:1,name:"AppUser",path:"/app/user",icon:"user"},{id:12,parentId:1,name:"AppDept",path:"/app/dept",icon:"office-building"},{id:13,parentId:1,name:"AppRole",path:"/app/role",icon:"avatar"},{id:14,parentId:1,name:"AppResource",path:"/app/resource",icon:"management"}]},{id:2,parentId:0,name:"Sys",path:"/sys",icon:"setting",children:[{id:21,parentId:2,name:"SysUser",path:"/sys/user",icon:"user-filled"},{id:22,parentId:2,name:"SysNotice",path:"/sys/notice",icon:"chat-dot-round"}]},{id:3,parentId:0,name:"Logs",path:"/logs",icon:"document",children:[{id:31,parentId:3,name:"LogsVisit",path:"/logs/visit",icon:"tickets"},{id:32,parentId:3,name:"LogsOperation",path:"/logs/operation",icon:"operation"}]}];function mt(){return{url:"login",method:"post",response:t=>{const o=t.data.account;return M.find(n=>n.name===o&&n.password===t.data.password)?{code:200,msg:"",data:{token:o+"@eyJhbGciOiJIUzUxMiJ9.eyJzdWIiOiJhZG1pbiIsImV4cC",name:o}}:{code:-1,msg:"\u7528\u6237\u540D\u6216\u5BC6\u7801\u9519\u8BEF"}}}}function _t(){return{url:"logout",method:"get",response:{code:200,msg:null,data:{}}}}var ft=Object.freeze(Object.defineProperty({__proto__:null,login:mt,logout:_t},Symbol.toStringTag,{value:"Module"}));function gt(){return{url:"personal/userinfo",method:"get",response:()=>{const t=localStorage.getItem("pm_token");if(t){const o=S({},M.find(n=>n.name===t.split("@")[0]));return delete o.password,{code:200,data:q(S({},o),{"unReadCount|0-10":0})}}else return{code:-2,msg:"\u8BF7\u5148\u767B\u5F55!"}}}}function ht(){return{url:"personal/menuTree",method:"get",response:()=>{const t=localStorage.getItem("pm_token");if(!t)return{code:200,msg:""};const o=t.split("@")[0],s=M.find(r=>r.name===o).roleId;let e=[D[2]];switch(s){case"admin":e=D;break;case"master":e=[D[0],D[2]];break;case"visitor":e=[D[2]];break}return{code:200,data:e}}}}var vt=Object.freeze(Object.defineProperty({__proto__:null,userInfo:gt,menuTree:ht},Symbol.toStringTag,{value:"Module"}));const{baseURL:yt}=ee,oe=!0;ne(ft,oe);ne(vt,oe);function ne(t,o=!0){if(o)for(var n in t)(s=>{if(s.isOpen!==!1){let e=yt;e.endsWith("/")||(e=e+"/"),e=e+s.url,G.mock(new RegExp(e),s.method,r=>{r.data=r.body?JSON.parse(r.body):null;const a=G.mock(typeof s.response=="function"?s.response(r):s.response);return console.log("%cmock\u62E6\u622A, \u8BF7\u6C42: ","color:blue",r),console.log("%cmock\u62E6\u622A, \u54CD\u5E94: ","color:blue",a),a})}})(t[n]()||{})}const se=Te(Ve);for(const t in K)se.component(t,K[t]);se.use(b).use(v).use(xe).mount("#app");export{tt as _,Et as l};
